(ns clj-vat.algo-test
  #+cljs  (:require-macros [cemerick.cljs.test
                    :refer (is are deftest with-test run-tests testing test-var)])
  #+cljs (:require [cemerick.cljs.test :as t]
                   [clj-vat.algo :as a])
  #+clj (:use clojure.test)
  #+clj (:require [clj-vat.algo :as a]))


(deftest test-->digits
  (are [i r] (= r (a/->digits i))
       "12345" [1 2 3 4 5]
       ["1" "2" "3" "4"] [1 2 3 4]
       12345 [1 2 3 4 5]))


(deftest test-+>9
  (are [i r] (= (a/+>9 i) r)
       12 3
       9 9
       111 3
       10 1
       11 2
       0 0))


(deftest test-luhn
  (are [i r] (= (a/luhn i) r)
       "5136160214196774" true
       "5136160214196773" false))

(deftest test->num
  (are [i r] (= r (a/->num i))
       [1 2 3 4 ] 1234))

(deftest test-check-vat-fr
  (are [i] (true? (a/check-vat-fr i))
           "00325422483"
           "00504137126"
           "01308148691"
           "02410043764"
           "03533645594"
           "05327925699"
           "05332944867"
           "05999990005"
           "09493241798"
           "10615920188"
           "11055501977"
           "11349352419"
           "12334502366"
           "12382577021"
           "12402385876"
           "12441639739"
           "12488632068"
           "13379608110"
           "15312631195"
           "17409032059"
           "17440389831"
           "18306369943"
           "18317328227"
           "18432626307"
           "20552140816"
           "22318546322"
           "22501687560"
           "22577380249"
           "22681750212"
           "25384801882"
           "25578801300"
           "26311799456"
           "26491219192"
           "26494929151"
           "27367801404"
           "28403857436"
           "29552088536"
           "31947251922"
           "32392677282"
           "36438324675"
           "37386220123"
           "37714501491"
           "38315907022"
           "38348352261"
           "38413058439"
           "38430097071"
           "38785620501"
           "39309634582"
           "39440270981"
           "40524399631"
           "41339045403"
           "41387565385"
           "41560502320"
           "42303993257"
           "43750542037"
           "44328918313"
           "44388481939"
           "45334835766"
           "46542060132"
           "47316474766"
           "47751918921"
           "48385406814"
           "49410252944"
           "49410323463"
           "49450767322"
           "51671920080"
           "52453093965"
           "52576480099"
           "53323181057"
           "53412603417"
           "54440085231"
           "55352496624"
           "56344752209"
           "57349033951"
           "57414817023"
           "58389479718"
           "58449286426"
           "59354500225"
           "59384822037"
           "59432429249"
           "60338216609"
           "60379011414"
           "60485314199"
           "60504648627"
           "60542084322"
           "60801543414"
           "61418574869"
           "62333286714"
           "63351577002"
           "66046850145"
           "68380313189"
           "68421343898"
           "68430360727"
           "68622001881"
           "69430456046"
           "69644200784"
           "71344122296"
           "72562008029"
           "75477632095"
           "76382290278"
           "76410255087"
           "78418114351"
           "79343464186"
           "82400519005"
           "82542007182"
           "83542050315"
           "84301125175"
           "85753182294"
           "85877280602"
           "87784173536"
           "88626250229"
           "89307049387"
           "89451190029"
           "89753948272"
           "91602002461"
           "92095780284"
           "92443201595"
           "93442769428"
           "94315030387"
           "94926450099"
           "95441297777"
           "95716220512"
           "96343149944"
           "96527512800"
           "96532768066"))




(deftest test-check-vat-gb
  (are [i] (true? (a/check-vat-gb i))
           "100146190"
           "100946989"
           "101474653"
           "103471944"
           "103590836"
           "105289914"
           "106125319"
           "106824188"
           "112341372"
           "112452654"
           "116440346"
           "116755802"
           "116910921"
           "119929241"
           "124808476"
           "125073834"
           "125342442"
           "126846944"
           "127747058"
           "131712157"
           "136374368"
           "137672493"
           "138025976"
           "140165745"
           "140840831"
           "142313749"
           "144137825"
           "144553711"
           "150045555"
           "154578582"
           "158291978"
           "160321161"
           "163597044"
           "168825915"
           "172351381"
           "173047125"
           "179387449"
           "182880774"
           "191044775"
           "197531237"
           "198187115"
           "202329313"
           "202429210"
           "213221231"
           "226556555"
           "238406267"
           "243208980"
           "246022296"
           "247103682"
           "254347459"
           "255073076"
           "275913139"
           "281355458"
           "288638008"
           "289234622"
           "303869943"
           "304766951"
           "307023112"
           "308302200"
           "308816452"
           "311057215"
           "316694833"
           "333851166"
           "339072747"
           "344407665"
           "347154553"
           "347597116"
           "349917606"
           "356527143"
           "378038429"
           "378097310"
           "397759080"
           "404065883"
           "412144601"
           "412672765"
           "414857050"
           "427335750"
           "429151752"
           "435000112"
           "439806813"
           "441831073"
           "445004484"
           "452052481"
           "461689319"
           "464275435"
           "468192123"
           "478080229"
           "484658693"
           "507642158"
           "516716936"
           "516884909"
           "518441844"
           "530215790"
           "537471726"
           "549798270"
           "553124860"
           "555054253"
           "557285804"
           "569869162"
           "570093452"
           "571258535"
           "581189224"
           "581198517"
           "581379120"
           "582341248"
           "593395888"
           "594261226"
           "594277693"
           "603871841"
           "607131476"
           "610809954"
           "611635076"
           "613731169"
           "619327237"
           "623008384"
           "624850146"
           "625512459"
           "631570164"
           "637035056"
           "641614164"
           "652253354"
           "662043655"
           "666322529"
           "674663206"
           "675597082"
           "679736957"
           "683254030"
           "683741214"
           "683867574"
           "689476165"
           "693195792"
           "694264601"
           "702719158"
           "703265267"
           "706725436"
           "712061386"
           "713804551"
           "714293150"
           "724283637"
           "724868502"
           "728520043"
           "733763031"
           "750044467"
           "750347737"
           "754173037"
           "759894254"
           "761236932"
           "763160441"
           "765365012"
           "768461392"
           "769784844"
           "770046839"
           "770817808"
           "771422931"
           "775247012"
           "778488846"
           "782333230"
           "783419405"
           "788603190"
           "788715077"
           "792409995"
           "794661973"
           "795095973"
           "795834568"
           "798573748"
           "803601569"
           "806607141"
           "810727157"
           "811094951"
           "816744906"
           "817032259"
           "825439027"
           "825823911"
           "829703900"
           "829890083"
           "830143667"
           "830865716"
           "836965674"
           "840722445"
           "846390994"
           "846528401"
           "847292106"
           "848243215"
           "858321217"
           "859484564"
           "861153244"
           "862819984"
           "862833505"
           "863009827"
           "864440910"
           "864721704"
           "866897052"
           "876152993"
           "880989655"
           "884493180"
           "892207710"
           "892741001"
           "899739918"
           "901232480"
           "901407467"
           "908691592"
           "912333361"
           "918198491"
           "918515023"
           "927114437"
           "927534115"
           "927577383"
           "929539969"
           "930303861"
           "930897591"
           "932869781"
           "933393415"
           "935273906"
           "938240223"
           "938827767"
           "945371312"
           "947205321"
           "947223711"
           "970899459"
           "971019624"
           "971082617"
           "973763084"
           "974666662"
           "974957354"
           "979190565"
           "979346459"
           "979389434"
           "981468383"
           "983190496"
           "984902088"
           "985134203"
           "986200020"
           "987966426"
           "996868620"
           "998718045"))


(deftest test-check-vat-dk
  (are [i](true? (a/check-vat-dk i))
       "13585628"
       "29425434"
       "67679628"
       "30861310"
       "56423818"
       "26366313"
       "25922921"
       "17026518"
       "27998895"
       "10664446"
       "27224849"
       "25586840"
       "15027800"
       "29425434"
       "81745528"))


(deftest test-check-vat-de
  (are [i] (true? (a/check-vat-de i))
           "116213911"
           "117658764"
           "117662628"
           "121967016"
           "123045750"
           "125081842"
           "126957135"
           "131934331"
           "136695976"
           "139233160"
           "146130661"
           "148418567"
           "148418567"
           "149320417"
           "157336064"
           "157796279"
           "170179642"
           "183677859"
           "189915799"
           "206169012"
           "209867508"
           "220716351"
           "236097644"
           "242080537"
           "254117387"
           "254176356"
           "255505922"
           "256092693"
           "260007172"
           "261263875"
           "261811370"
           "267301179"
           "267844793"
           "273414958"
           "273967855"
           "279201460"
           "281604179"
           "284928405"
           "292143324"
           "811152493"
           "811152493"
           "811152493"
           "811152493"
           "811152493"
           "811423486"
           "811698404"
           "812139660"
           "812227901"
           "812463252"
           "812761885"
           "812803588"
           "813337219"
           "813632841"
           "813821430"
           "813851493"))


 (deftest test-check-vat-pl
   (are [i] (true? (a/check-vat-pl i))
            "1010003756"
            "1130017933"
            "1130039461"
            "1182081972"
            "1230007271"
            "5210086737"
            "5210089960"
            "5213405781"
            "5220103934"
            "5240401310"
            "5242388571"
            "5252109503"
            "5261013323"
            "5270022391"
            "5270103824"
            "5270104717"
            "5841031823"
            "5842394781"
            "5851356886"
            "5871283050"
            "5890011743"
            "5911003253"
            "6060069352"
            "6151666800"
            "6180017056"
            "6272494255"
            "6460000312"
            "6621004747"
            "6681941935"
            "7250013591"
            "7251959614"
            "7610002225"
            "7761002967"
            "7773224366"
            "7790002272"
            "8121766337"
            "8130012922"
            "8310003586"
            "8381000827"
            "8520000358"
            "8520600578"
            "8722106396"
            "9231508677"))



 (deftest test-check-vat-it
   (are [i] (true? (a/check-vat-it i))
            "00004330544"
            "00009070285"
            "00359320264"
            "00416940476"
            "00524760246"
            "00537550261"
            "00656120367"
            "00743560153"
            "00750560211"
            "00891230153"
            "01106310939"
            "01231680156"
            "01486370404"
            "01656160692"
            "03430790240"
            "03928150402"
            "03928150402"
            "06015890012"
            "07047090159"
            "07843350153"
            "08102830018"
            "08983530158"
            "10365960151"
            "12345670785"))


 (deftest test-check-vat-pt
   (are [i] (true? (a/check-vat-pt i))
        "503272337"
        "501721630"
        "506510441"
        "501745815"
        "500017921"
        "500731993"
        "506000478"
        "504406400"
        "500461481"
        "504158899"
        "501393749"
        "500076090"
        "136695973"
        "500095922"
        "500163510"
        "500306486"
        "500287600"
        "501698540"
        "500002614"
        "501578102"
        "500627126"
        "500313687"
        "500287058"
        "500287058"
        "501522220"
        "502025140"
        "500020639"
        "502025140"
        "500212848"
        "500218412"
        "503425206"
        "504218581"))


 (deftest test-check-vat-es
   (are [i] (true? (a/check-vat-es i))
            "A04344115"
            "A08711558"
            "A20038394"
            "A20099305"
            "A28110682"
            "A30049530"
            "A30057814"
            "A30060180"
            "A31064561"
            "A31074164"
            "A31126758"
            "A33034836"
            "A46054987"
            "A47060108"
            "A58590670"
            "A78084365"
            "A79326021"
            "A83344325"
            "B02367969"
            "B11024262"
            "B11024262"
            "B17150228"
            "B17807793"
            "B18849265"
            "B20640942"
            "B20703732"
            "B21026109"
            "B21040050"
            "B21179841"
            "B21227004"
            "B30029821"
            "B30149397"
            "B30425060"
            "B30483861"
            "B30523203"
            "B30574933"
            "B41544701"
            "B43118934"
            "B50600527"
            "B55059943"
            "B61030276"
            "B62948468"
            "B65632440"
            "B72139629"
            "B73047599"
            "B73094716"
            "B73135717"
            "B73468746"
            "B73490849"
            "B73650152"
            "B73840159"
            "B78503406"
            "B81096471"
            "B91194373"
            "B91491076"
            "B92964907"
            "B98059876"
            "B98282973"
            "B98328891"
            "F18011031"
            "F30051908"
            "F30144745"))


 (deftest test-check-vat-be
   (are [i] (true? (a/check-vat-be i))
            "0136695962"
            "0308357555"
            "0401296720"
            "0404199394"
            "0405490781"
            "0407021502"
            "0407735837"
            "0414246121"
            "0419734638"
            "0425067361"
            "0432999288"
            "0437013209"
            "0441288830"
            "0441995940"
            "0446616407"
            "0448321627"
            "0449424358"
            "0449443659"
            "0459624503"
            "0462172237"
            "0465288412"
            "0474288329"
            "0475454606"
            "0478171891"
            "0478522972"
            "0479540482"
            "0818275865"
            "0822752119"
            "0887603151"
            "0896078476"))


(deftest test-check-ident-be
  (are [i] (true? (a/check-ident i))
           "BE0136695962"
           "BE0308357555"
           "BE0401296720"
           "BE0404199394"
           "BE0896078476"))



 (deftest test-check-vat-hu
   (are [i] (true? (a/check-vat-hu i))
            "10210798"
            "10252435"
            "10562112"
            "10813566"
            "10862508"
            "10896798"
            "11125633"
            "11168625"
            "11832700"
            "12631368"
            "12644504"
            "13323260"
            "13632142"
            "14132164"
            "17781578"))

 (deftest test-check-vat-nl
   (are [i] (true? (a/check-vat-nl i))
            "001236362B01"
            "001266706B01"
            "001266706B01"
            "001337476B01"
            "001337476B01"
            "001351746B01"
            "001524598B01"
            "001625123B01"
            "001733540B01"
            "001733540B01"
            "002345742B01"
            "002629744B01"
            "002837110B01"
            "003203098B01"
            "003360179B01"
            "003528261B01"
            "003590094B01"
            "003590094B01"
            "003813095B03"
            "004059530B01"
            "004193866B01"
            "004201991B01"
            "004297209B01"
            "004297234B01"
            "004297234B05"
            "004327822B13"
            "004407970B01"
            "004748906B01"
            "004799975B01"
            "004799975B01"
            "004799975B01"
            "004799975B01"
            "004799975B01"
            "004937338B01"
            "005286177B02"
            "005395732B01"
            "005449960B03"
            "005467755B01"
            "005652285B01"
            "005730065B01"
            "005799405B04"
            "005824813B04"
            "005928862B01"
            "006115391B01"
            "006314193B02"
            "006314193B06"
            "006575651B03"
            "006575651B03"
            "006579425B01"
            "006883011B01"
            "006918293B01"
            "006918293B01"
            "006918293B01"
            "006942027B01"
            "006953608B01"
            "006991403B01"
            "007063544B04"
            "007122998B01"
            "007156054B01"
            "007294347B03"
            "007772555B01"
            "007953525B01"
            "008165701B02"
            "008187162B05"
            "008225497B01"
            "008709282B01"
            "008740331B01"
            "008867343B01"
            "008917437B03"
            "009014251B01"
            "009143488B01"
            "009215232B01"
            "009769304B01"
            "063235833B01"
            "119965689B01"
            "235270179B01"
            "800366268B03"
            "800583668B01"
            "800669046B01"
            "800904965B05"
            "800995004B01"
            "801283929B02"
            "801283929B04"
            "801283929B04"
            "801283929B04"
            "801288794B01"
            "801427770B01"
            "801880804B01"
            "803936631B01"
            "803936631B01"
            "803936631B01"
            "805356472B01"
            "805356472B01"
            "805695187B01"
            "805695187B01"
            "805695187B01"
            "805695187B01"
            "806235093B01"
            "806639556B01"
            "806763206B06"
            "806763206B06"
            "806943476B01"
            "806943476B01"
            "807181845B01"
            "807366845B01"
            "807665538B01"
            "808248455B01"
            "808286997B01"
            "808698746B01"
            "809096444B01"
            "809203844B01"
            "809203844B01"
            "810411970B01"
            "810617511B01"
            "810617511B01"
            "810717360B01"
            "811514274B01"
            "811514274B01"
            "811514274B01"
            "811514274B01"
            "817911510B01"))

 (deftest test-check-vat-se
   (are [i] (true? (a/check-vat-se i))
        "136695975523"))


 (deftest test-check-vat-el
   (are [i] (true? (a/check-vat-el i))
        "123456783"))

 (deftest test-check-vat-ie
   (are [i] (true? (a/check-vat-ie i))
        "6599525K"
        "4870800A"
        "6322073C"
        "8F47910T"
        "4574973H"
        "8F85560M"
        "9F69313D"
        "8F61758E"
        "4571931W"
        "4809539S"
        "6589960W"
        "6569740T"
        "4809539S"
        "9568085J"
        "6586063A"
        "6553007D"
        "4620030C"
        "8236506T"
        "4799334B"
        "0526750E"
        "4536860D"))


 (deftest test-check-vat-at
   (are [i] (true? (a/check-vat-at i))
        "U13585627"
        "U30164005"
        "U34260000"
        "U34699207"
        "U51025000"
        "U35613608"
        "U35613608"
        "U35613608"
        "U15393205"
        "U29074701"
        "U46153102"
        "U15301206"
        "U46234105"
        "U44463503"
        "U19208701"
        "U19208701"
        "U19208701"
        "U19208701"
        "U20785309"
        "U35613608"
        "U46234105"
        "U15383403"))


 (deftest test-check-vat-is
   (are [i] (true? (a/check-vat-is i))
        "23311347"
        "23191503"
        "64665020"
        "56405006"
        "18805477"
        "81959745"
        "77779517"
        "72161248"
        "16519949"
        "52690644"
        "46695966"))

 (deftest test-check-vat-fi
   (are [i] (true? (a/check-vat-fi i))
        "13669598"))

 (deftest test-check-vat-lu
   (are [i] (true? (a/check-vat-lu i))
        "17458960"
        "14492937"
        "11742635"
        "12192281"
        "13083505"
        "14492937"
        "16965218"
        "17458960"
        "18147908"
        "15959114"
        "15068003"
        "18329342"
        "15349155"
        "10522325"
        "18028257"
        "19803611"
        "19088973"
        "18668754"
        "17458960"
        "17458960"
        "14922662"
        "17044510"
        "18970647"
        "21623857"
        "16468636"))


(deftest test-check-vat-bg
  (are [i] (true? (a/check-vat-bg i))
           "121446525"
           "202272022"
           "201820473"
           "202188510"
           "030215845"
           "201271946"
           "175200037"))

(deftest test-check-vat-lt
  (are [i] (true? (a/check-vat-lt i))
           "501643716"
           "100005407518"
           "100001123912"
           "633770418"))

(deftest test-check-vat-si
  (are [i] (true? (a/check-vat-si i))
           "80901042"
           "38211670"
           "64665020"
           "41200900"
           "51033224"
           "23191503"
           "60031751"
           "77048008"))


(deftest test-check-vat-sk
  (are [i] (true? (a/check-vat-sk i))
           "2021869267"
           "2020393749"
           "2022096901"
           "2020295156"
           "2022916819"
           "2022704805"))


(deftest test-check-vat-lv
  (are [i] (true? (a/check-vat-lv i))
           "40003649404"
           "40003009497"
           "50003993021"))


(deftest test-check-vat-mt
  (are [i] (true? (a/check-vat-mt i))
           "15121333"))


#_(deftest test-check-ident-no
  (are [i] (true? (a/check-vat-no i))
           "NO15121333"))



(deftest test-check-ident-che
  (are [i] (true? (a/check-ident i))
           "CHE100738566"
           "CHE105778633"
           "CHE105880361"
           "CHE105930993"
           "CHE105950470"
           "CHE107698407"
           "CHE116287842"
           "CHE280763979"))


(deftest test-check-ident-cy
  (are [i] (true? (a/check-ident i))
           "00532445O"))

(time
  (run-tests))



